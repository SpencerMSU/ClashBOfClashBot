# Структура проекта ClashBot

## 📁 Новая организация файлов

Проект был реструктуризирован для лучшей организации и поддержки:

```
ClashBOfClashBot/
├── 📁 src/                          # Исходный код приложения
│   ├── 📁 core/                     # Основная логика бота
│   │   ├── bot.py                   # Главный класс бота
│   │   ├── handlers.py              # Обработчики сообщений и callbacks
│   │   ├── message_generator.py     # Генератор сообщений
│   │   ├── keyboards.py             # Клавиатуры и кнопки
│   │   └── user_state.py           # Состояния пользователя
│   ├── 📁 services/                # Сервисы и внешние интеграции
│   │   ├── database.py             # Работа с базой данных
│   │   ├── coc_api.py              # API Clash of Clans
│   │   ├── payment_service.py      # Платежная система
│   │   ├── war_archiver.py         # Архивация войн
│   │   └── building_monitor.py     # Мониторинг зданий
│   ├── 📁 models/                  # Модели данных
│   │   ├── user.py                 # Модель пользователя
│   │   ├── war.py                  # Модели войн
│   │   ├── subscription.py         # Модель подписки
│   │   ├── building.py             # Модели зданий
│   │   ├── user_profile.py         # Профили пользователей
│   │   └── linked_clan.py          # Связанные кланы
│   ├── 📁 scanners/                # Сканеры кланов и войн
│   │   ├── clan_scanner.py         # Непрерывный сканер
│   │   └── war_importer.py         # Импортер войн
│   └── 📁 utils/                   # Утилиты и вспомогательные функции
│       ├── translations.py         # Система переводов
│       ├── building_data.py        # Данные о зданиях
│       └── policy.py               # Политики использования
├── 📁 config/                      # Конфигурация
│   ├── config.py                   # Основная конфигурация
│   ├── api_tokens.txt              # API токены
│   └── .env.example                # Пример переменных окружения
├── 📁 docs/                        # Документация
│   ├── New_updates.md              # Обновления проекта
│   ├── Go_migration.md             # План миграции на Go
│   ├── ALL_IMPORTER_README.md      # Документация импортера
│   └── ...                         # Другая документация
├── 📁 scripts/                     # Скрипты и утилиты
│   ├── all_importer.py             # Импортер всех кланов
│   ├── errors.py                   # Обработчик ошибок
│   ├── validate.py                 # Валидация компонентов
│   └── validate_importer.py        # Валидация импортера
├── 📁 tests/                       # Тесты
│   └── test_compatibility.py       # Тесты совместимости
├── 📁 data/                        # Данные приложения
│   ├── *.db                        # Файлы базы данных
│   ├── *.json                      # JSON файлы с данными
│   └── *.txt                       # Текстовые файлы с данными
├── 📁 cmd/                         # Go версия (будущая)
├── 📁 internal/                    # Go внутренние пакеты
├── 📁 pkg/                         # Go публичные пакеты
├── main.py                         # Точка входа в приложение
├── requirements.txt                # Python зависимости
├── go.mod                          # Go модуль
└── .gitignore                      # Игнорируемые файлы
```

## 🔄 Изменения в импортах

После реструктуризации все импорты были обновлены:

### Основные модули:
```python
# Старое
from bot import ClashBot
from config import config

# Новое
from src.core.bot import ClashBot
from config.config import config
```

### Сервисы:
```python
# Старое
from database import DatabaseService
from coc_api import CocApiClient

# Новое
from src.services.database import DatabaseService
from src.services.coc_api import CocApiClient
```

### Модели:
```python
# Старое
from models.user import User

# Новое
from src.models.user import User
```

## 🚀 Запуск приложения

После реструктуризации запуск остается таким же:

```bash
# Основной бот
python main.py

# Импортер войн
python src/scanners/war_importer.py

# Импортер всех кланов
python scripts/all_importer.py

# Обработчик ошибок
python scripts/errors.py
```

## 📋 Преимущества новой структуры

1. **Лучшая организация** - логическое разделение по функциональности
2. **Упрощенная навигация** - легче найти нужный файл
3. **Модульность** - четкое разделение ответственности
4. **Масштабируемость** - легче добавлять новые функции
5. **Тестирование** - отдельная папка для тестов
6. **Документация** - централизованная документация
7. **Конфигурация** - изолированные настройки

## 🛠️ Совместимость

Все существующие функции остались без изменений:
- ✅ Основная функциональность бота
- ✅ Импортеры войн
- ✅ Сканеры кланов
- ✅ Система платежей
- ✅ Мониторинг зданий
- ✅ База данных
- ✅ API интеграции

## 📝 Следующие шаги

1. Протестировать работу всех модулей
2. Обновить deployment скрипты (если есть)
3. Обновить CI/CD конфигурацию (если есть)
4. Добавить дополнительные тесты для новой структуры