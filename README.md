# Clash of Clans Telegram Bot

Telegram-–±–æ—Ç –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–ª–∞–Ω–æ–≤ –≤ Clash of Clans —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º –∞–Ω–∞–ª–∏–∑–∞ –≤–æ–π–Ω.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- üîó –ü—Ä–∏–≤—è–∑–∫–∞ –∏–≥—Ä–æ–≤—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∫ Telegram
- üõ°Ô∏è –ü–æ–∏—Å–∫ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–ª–∞–Ω–∞—Ö  
- üë• –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∫–ª–∞–Ω–∞ —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
- ‚öîÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–π–Ω
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–æ–π–Ω –∏ –∞—Ç–∞–∫
- üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è HTML —Ñ–∞–π–ª–æ–≤ –≤–æ–π–Ω –≤ JSON

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```bash
cp src/main/resources/config.properties.example src/main/resources/config.properties
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `config.properties`:

```properties
# Telegram Bot Configuration
bot.token=YOUR_BOT_TOKEN_HERE
bot.username=YOUR_BOT_USERNAME_HERE

# Clash of Clans API Configuration  
coc.api.token=YOUR_COC_API_TOKEN_HERE

# Application Configuration
app.htmls.directory=data/htmls
app.output.json=data/war_data.json
app.clan.tag=#YOUR_CLAN_TAG
```

### 2. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í–º–µ—Å—Ç–æ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
export BOT_TOKEN="your_bot_token"
export BOT_USERNAME="your_bot_username"  
export COC_API_TOKEN="your_coc_api_token"
export CLAN_TAG="#your_clan_tag"
```

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

#### Telegram Bot Token
1. –ù–∞–π–¥–∏—Ç–µ @BotFather –≤ Telegram
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ–π `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω

#### Clash of Clans API Token
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://developer.clashofclans.com/
2. –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç –∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–ª—é—á API
3. –£–∫–∞–∂–∏—Ç–µ –≤–∞—à IP-–∞–¥—Ä–µ—Å

## –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Java 11+
- Maven 3.6+

### –ö–æ–º–ø–∏–ª—è—Ü–∏—è
```bash
mvn compile
```

### –ó–∞–ø—É—Å–∫
```bash
mvn exec:java -Dexec.mainClass="org.example.Main"
```

### –°–æ–∑–¥–∞–Ω–∏–µ JAR —Ñ–∞–π–ª–∞
```bash
mvn package
java -jar target/MainPr-1.0-SNAPSHOT-jar-with-dependencies.jar
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/main/java/org/example/
‚îú‚îÄ‚îÄ Main.java                      # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ HtmlToJsonConverter.java       # –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä HTML ‚Üí JSON
‚îú‚îÄ‚îÄ WarArchiver.java              # –ê—Ä—Ö–∏–≤–∞—Ç–æ—Ä –≤–æ–π–Ω
‚îú‚îÄ‚îÄ bot/                          # Telegram bot –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ cocapi/                       # Clash of Clans API –∫–ª–∏–µ–Ω—Ç
‚îú‚îÄ‚îÄ config/                       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ database/                     # –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
- `/start` - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- **üë§ –ü—Ä–æ—Ñ–∏–ª—å** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–≤—ã–º –ø—Ä–æ—Ñ–∏–ª–µ–º
- **üõ° –ö–ª–∞–Ω** - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∞–Ω–∞—Ö
- **üîó –ü—Ä–∏–≤—è–∑–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç** - –°–≤—è–∑–∞—Ç—å Telegram —Å –∏–≥—Ä–æ–≤—ã–º –∞–∫–∫–∞—É–Ω—Ç–æ–º

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è HTML —Ñ–∞–π–ª–æ–≤
–ü–æ–º–µ—Å—Ç–∏—Ç–µ HTML —Ñ–∞–π–ª—ã –≤–æ–π–Ω –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `data/htmls/` –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
java -cp target/classes org.example.HtmlToJsonConverter
```

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQLite –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö `clashbot.db` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è:
- –°–≤—è–∑–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏–≥—Ä–æ–≤—ã–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
- –ò—Å—Ç–æ—Ä–∏–∏ –≤–æ–π–Ω  
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∞—Ç–∞–∫
- –ù–∞—Å—Ç—Ä–æ–µ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## Troubleshooting

### –û—à–∏–±–∫–∞ 403 –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ API
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à IP-–∞–¥—Ä–µ—Å –¥–æ–±–∞–≤–ª–µ–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ API –∫–ª—é—á–∞

### –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `config.properties` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ `src/main/resources/`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –∑–∞–ø–∏—Å–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ SQLite –¥—Ä–∞–π–≤–µ—Ä –≤–∫–ª—é—á–µ–Ω –≤ classpath

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–∞–∫–µ—Ç–∞—Ö
2. –û–±–Ω–æ–≤–∏—Ç–µ `BotConfig.java` –¥–ª—è –Ω–æ–≤—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
3. –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ `MessageHandler` –∏–ª–∏ `CallbackHandler`

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
mvn test
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π.